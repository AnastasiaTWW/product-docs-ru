# Доступ к Валарм API через прокси‑сервер

Инструкция описывает настройку доступа к адресам Валарм API ниже через прокси‑сервер.

* `https://api.wallarm.com:444` для EU‑облака
* `https://api.wallarm.ru:444` для RU‑облака

Чтобы настроить доступ, в файле `/etc/environment` необходимо присвоить новые значения переменным окружения, которые определяют используемый прокси‑сервер:

* `https_proxy` — прокси для протокола HTTPS
* `http_proxy` — прокси для протокола HTTP
* `no_proxy` — ресурсы, для запросов к которым необходимо отключить проксирование

## Значение https_proxy и http_proxy

Присвойте переменным `https_proxy` и `http_proxy` строки вида `<scheme>://<proxy_user>:<proxy_pass>@<host>:<port>`, где:

* `<scheme>` — используемый протокол (должен совпадать с протоколом, для которого настраивается прокси в текущей переменной окружения)
* `<proxy_user>` — имя пользователя для авторизации на прокси‑сервере
* `<proxy_pass>` — пароль для авторизации на прокси‑сервере
* `<host>` — хост используемого прокси‑сервера
* `<port>` — порт используемого прокси‑сервера

## Значение no_proxy

Присвойте переменной `no_proxy` значение в виде массива IP‑адресов и/или доменов, к которым нужно обращаться без использования прокси:

* `127.0.0.1`, `127.0.0.8`, `127.0.0.9` и `localhost` для корректной работы WAF‑ноды Валарм
* дополнительные адреса в формате `"<res_1>, <res_2>, <res_3>, <res_4>, ..."`, где `<res_1>`, `<res_2>`, `<res_3>` и `<res_4>` — IP‑адреса и/или домены

## Пример файла /etc/environment

Пример файла `/etc/environment` ниже описывает следующую конфигурацию:

* HTTPS‑ и HTTP‑запросы проксируются на хост `1.2.3.4` с портом `1234`, используя для авторизации на прокси‑сервере имя пользователя `admin` и пароль `01234`
* для запросов к `127.0.0.1`, `127.0.0.8`, `127.0.0.9` и `localhost` проксирование отключено

```bash
https_proxy=http://admin:01234@1.2.3.4:1234
http_proxy=http://admin:01234@1.2.3.4:1234
no_proxy="127.0.0.1, 127.0.0.8, 127.0.0.9, localhost"
```
