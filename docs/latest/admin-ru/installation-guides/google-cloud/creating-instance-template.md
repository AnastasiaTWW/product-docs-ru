[img-creating-template]:                ../../../images/installation-gcp/auto-scaling/common/autoscaling-group-guide/create-instance-template.png
[img-selecting-image]:                  ../../../images/installation-gcp/auto-scaling/common/autoscaling-group-guide/select-image.png

[link-creating-image]:                  create-image.md
[link-creating-instance-group]:         creating-autoscaling-group.md

#  Создание шаблона экземпляра WAF‑ноды

Вам необходимо создать шаблон экземпляра WAF‑ноды, на основе которого затем будет создана управляемая группа экземпляров виртуальных машин. Для этого выполните следующие действия:

1.  Перейдите на страницу «Instance templates» в разделе «Compute Engine» навигационного меню и нажмите на кнопку «Create instance template»;
    
    ![!Создание шаблона экземпляра][img-creating-template]
    
2.  Введите имя создаваемого шаблона в поле «Name»;
3.  Выберите необходимый тип виртуальной машины, на которой будет запускаться WAF‑нода, в поле «Machine type»; 

    !!! warning "Выбор типа виртуальной машины"
        Выбирайте тот же тип виртуальной машины, который вы использовали при первоначальной настройке WAF‑ноды, или более мощный. 
        
        Использование менее мощного типа виртуальной машины может привести к проблемам в работе WAF‑ноды.

4.  Нажмите на кнопку «Change» в пункте «Boot disk». В появившемся окне перейдите на вкладку «Custom images» и в выпадающем списке «Show images from» выберите имя проекта, в рамках которого вы создавали образ виртуальной машины. В списке доступных образов проекта выберите [созданный вами ранее образ][link-creating-image] и нажмите на кнопку «Select».

    ![!Выбор образа виртуальной машины][img-selecting-image]
    
5.  Для того, чтобы инстансы на основе создаваемого шаблона были идентичны базовому инстансу, настройте все прочие параметры аналогично параметрам, которые вы настраивали при [создании базового инстанса][link-creating-image].
    
    !!! info "Настройка файерволла"
        Убедитесь, что файерволл не блокирует HTTP‑трафик для создаваемого шаблона. Для этого поставьте галочку «Allow HTTP traffic».
    
    !!! info "Подключение к инстансу с использованием собственного закрытого ключа"
        Если в процессе создания инстанса вы настроили собственную пару SSH-ключей для использования вместо пары ключей проекта при подключении к инстансу по протоколу SSH, то убедитесь, что вы имеете доступ к закрытому ключу из этой пары.

6.  Нажмите на кнопку «Create» и дождитесь создания шаблона. 

После создания шаблона экземпляра WAF‑ноды вы можете приступать к [созданию группы экземпляров][link-creating-instance-group].
