[cwe-22]:   https://cwe.mitre.org/data/definitions/22.html
[cwe-78]:   https://cwe.mitre.org/data/definitions/78.html
[cwe-79]:   https://cwe.mitre.org/data/definitions/79.html
[cwe-89]:   https://cwe.mitre.org/data/definitions/89.html
[cwe-90]:   https://cwe.mitre.org/data/definitions/90.html
[cwe-93]:   https://cwe.mitre.org/data/definitions/93.html
[cwe-94]:   https://cwe.mitre.org/data/definitions/94.html
[cwe-113]:  https://cwe.mitre.org/data/definitions/113.html
[cwe-159]:  https://cwe.mitre.org/data/definitions/159.html
[cwe-200]:  https://cwe.mitre.org/data/definitions/200.html
[cwe-209]:  https://cwe.mitre.org/data/definitions/209.html
[cwe-215]:  https://cwe.mitre.org/data/definitions/215.html
[cwe-288]:  https://cwe.mitre.org/data/definitions/288.html
[cwe-307]:  https://cwe.mitre.org/data/definitions/307.html
[cwe-352]:  https://cwe.mitre.org/data/definitions/352.html
[cwe-425]:  https://cwe.mitre.org/data/definitions/425.html
[cwe-444]:  https://cwe.mitre.org/data/definitions/444.html
[cwe-511]:  https://cwe.mitre.org/data/definitions/511.html
[cwe-521]:  https://cwe.mitre.org/data/definitions/521.html
[cwe-538]:  https://cwe.mitre.org/data/definitions/538.html
[cwe-541]:  https://cwe.mitre.org/data/definitions/541.html
[cwe-548]:  https://cwe.mitre.org/data/definitions/548.html
[cwe-601]:  https://cwe.mitre.org/data/definitions/601.html
[cwe-611]:  https://cwe.mitre.org/data/definitions/611.html
[cwe-799]:  https://cwe.mitre.org/data/definitions/799.html
[cwe-639]:  https://cwe.mitre.org/data/definitions/639.html
[cwe-918]:  https://cwe.mitre.org/data/definitions/918.html
[cwe-943]:  https://cwe.mitre.org/data/definitions/943.html

[link-cwe]: https://cwe.mitre.org/

[link-owasp-xxe-cheatsheet]:                https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html
[link-owasp-xss-cheatsheet]:                https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html
[link-owasp-idor-cheatsheet]:               https://cheatsheetseries.owasp.org/cheatsheets/Insecure_Direct_Object_Reference_Prevention_Cheat_Sheet.html
[link-owasp-ssrf-cheatsheet]:               https://cheatsheetseries.owasp.org/cheatsheets/Server_Side_Request_Forgery_Prevention_Cheat_Sheet.html
[link-owasp-auth-cheatsheet]:               https://cheatsheetseries.owasp.org/cheatsheets/Authentication_Cheat_Sheet.html
[link-owasp-ldapi-cheatsheet]:              https://cheatsheetseries.owasp.org/cheatsheets/LDAP_Injection_Prevention_Cheat_Sheet.html
[link-owasp-sqli-cheatsheet]:               https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html

[link-ptrav-mitigation]:                    https://www.checkmarx.com/knowledge/knowledgebase/path-traversal
[link-wl-process-time-limit-directive]:     admin-ru/configure-parameters-ru.md#wallarm_process_time_limit

[doc-vpatch]:   user-guides/rules/vpatch-rule.md

[anchor-main-list]:     #основной-список-атак-и-уязвимостей        
[anchor-special-list]:  #список-особых-атак-и-уязвимостей

[anchor-brute]: #брутфорс-англ-bruteforce-attack
[anchor-rce]:   #удаленное-выполнение-кода-англ-remote-code-execution-rce
[anchor-ssrf]:  #подделка-запросов-на-стороне-сервера-англ-server-side-request-forgery-ssrf


#   Типы атак и уязвимостей

WAF‑нода Валарм способна обнаружить множество атак и уязвимостей. Их список приведен [ниже][anchor-main-list].

Для каждого элемента в списке указаны:
*   пометка о том, является ли он атакой или уязвимостью;

    Названия некоторых атак могут совпадать с названием уязвимости, которую они эксплуатируют. В этом случае элемент в списке будет иметь пометку **Уязвимость/Атака**.        

*   код Валарм, соответствующий уязвимости или атаке.

Для большинства атак и уязвимостей также указаны один или несколько кодов, соответствующих уязвимости или атаке из списка распространенных слабых мест в безопасности программного обеспечения (англ. [Common Weakness Enumeration][link-cwe], CWE).

Кроме этого, WAF‑нода Валарм использует несколько особых типов атак и уязвимостей в служебных целях для маркировки обработанного трафика. Для таких атак и уязвимостей нет кода CWE и их список приведен [отдельно][anchor-special-list].

??? info "Смотреть видео Валарм о защите приложений от угроз OWASP Top 10"
    <div class="video-wrapper">
    <iframe width="1280" height="720" src="https://www.youtube.com/embed/27CBsTQUE-Q" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
    </div>

##  Основной список атак и уязвимостей


### Атака на внешние XML‑сущности (XML External Entity, XXE)

**Уязвимость/Атака**<br>
**Код CWE:** [CWE-611][cwe-611]<br>
**Код Валарм:** `xxe`

**Описание:**

Уязвимость к атаке XXE заключается в том, что злоумышленник способен внедрить внешние сущности в структуру XML‑документов, которые будут обработаны XML‑парсером и выполнены на целевом веб-сервере. 

В результате реализации атаки злоумышленник будет иметь возможности для:
*   получения доступа к конфиденциальным данным веб‑приложения; 
*   осуществления атаки [SSRF][anchor-ssrf]; 
*   сканирования внутренней сети;
*   чтения локальных файлов на веб-сервере;
*   осуществления DoS-атак. 

Данная уязвимость существует из‑за отсутствия запрета на разрешение внешних сущностей XML в веб‑приложении.

**Рекомендации по устранению:**

Вы можете последовать следующим рекомендациям:
*   отключить разрешение внешних XML‑сущностей при работе с пользовательскими XML‑документами;
*   воспользоваться рекомендациями из [OWASP XXE Prevention Cheatsheet][link-owasp-xxe-cheatsheet].


### Брутфорс (англ. Bruteforce attack)

**Атака**<br> 
**Код CWE:** [CWE-307][cwe-307], [CWE-521][cwe-521], [CWE-799][cwe-799]<br>
**Код Валарм:** `brute`

**Описание:**

Брутфорс атака (также известна как «атака перебором» и «метод грубой силы») предполагает отправку множества запросов к серверу с предопределенным значениями (значения могут быть сгенерированы автоматически или взяты из словаря) и анализ ответа сервера с целью подбора необходимых данных.

В результате успешной реализации такой атаки злоумышленник может обойти механизмы аутентификации и авторизации, обнаружить скрытые ресурсы веб‑приложения (директории, файлы, разделы сайта и т.п.) и выполнять иные вредоносные действия.

**Рекомендации по устранению:**

Вы можете последовать следующим рекомендациям:
*   ввести ограничения на количество поступающих запросов к веб‑приложению в единицу времени;
*   ввести ограничения на количество попыток аутентификации или авторизации в единицу времени;
*   блокировать дальнейшие попытки аутентификации и авторизации после нескольких неудачных попыток;
*   установить минимально возможные права на доступ к директориям и файлам веб‑приложения;
*   ограничить доступ приложения к другим директориям и файлам сервера, на котором выполняется веб‑приложение.

[Как настроить Валарм WAF для защиты от брутфорса →](admin-ru/configuration-guides/protecting-against-bruteforce.md)

??? info "Смотреть видео Валарм о брутфорс‑атаках"
    <div class="video-wrapper">
    <iframe width="1280" height="720" src="https://www.youtube.com/embed/0R_2wL5_a-I" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
    </div>

### Изучение ресурса сторонним сканером

**Атака**<br>
**Код CWE:** нет<br>
**Код Валарм:** `scanner`

**Описание:**      

Такой код присваивается HTTP‑запросу, если обнаруживается факт атаки на защищаемый ресурс или изучения этого ресурса с помощью стороннего сканера (запросы сканера Валарм не считаются атакой).

**Рекомендации по устранению:**

Вы можете последовать следующим рекомендациям:
*   использовать фильтрацию по IP‑адресу, белые или черные списки, различные механизмы аутентификации и авторизации для снижения вероятности сканирования периметра злоумышленником;
*   минимизировать плоскость сканирования путем установки файервола для защиты сетевого периметра;
*   оставлять открытым минимально возможный набор сетевых портов;
*   ограничить использование протокола ICMP в сети;
*   проводить своевременное обновление компонентов ИТ-инфраструктуры, в том числе: 
    *   прошивок серверов и другого оборудования; 
    *   операционных систем;
    *   прочего программного обеспечения.


### Инъекция шаблона на стороне сервера (англ. Server Side Template Injection, SSTI)

**Уязвимость/Атака**<br>
**Код CWE:** [CWE-94][cwe-94], [CWE-159][cwe-159]<br>
**Код Валарм:** `ssti`

**Описание:**

Уязвимость к атаке типа «Server-Side Template Injection» позволяет злоумышленнику внедрить в форму пользовательского ввода исполняемую конструкцию, которая в результате будет обработана шаблонизатором на стороне веб-сервера. 

В результате эксплуатации данной уязвимости злоумышленник имеет возможность создавать произвольные запросы к веб-серверу, обращаться к его файловой системе, а также при определенных условиях удаленно выполнять произвольный код ([атака RCE][anchor-rce]).

Уязвимость к атакам данного типа возникает из‑за некорректной фильтрации входных пользовательских данных.

**Рекомендации по устранению:**

Вы можете последовать следующей рекомендации: параметры, получаемые веб‑приложением, должны проходить процессы санитизации (англ. sanitization) и фильтрации для предотвращения исполнения управляющих конструкций.


### Логическая бомба (англ. Logic Bomb)

**Атака**<br> 
**Код CWE:** [CWE-511][cwe-511]<br>
**Код Валарм:** `logic_bomb`

**Описание:**

Логическая бомба — это вредоносный код, который запускается при определенных условиях для осуществления вредоносных действий. Также известен вариант логической бомбы под названием «временная бомба» (англ. time bomb): такая бомба срабатывает при наступлении определенной даты или времени. 

Типичным примером логической бомбы является программа, контролирующая систему начисления заработной платы компании и атакующая компанию при условии увольнения конкретного работника.

**Рекомендации по устранению:**

Вы можете последовать следующим рекомендациям:
*   использовать статические или динамические анализаторы кода;
*   тщательно исследовать весь код, который не покрывается тестами;
*   контролировать целостность устанавливаемого программного обеспечения (например, с помощью механизма цифровой подписи).


### Межсайтовый скриптинг (англ. Cross-site Scripting, XSS)

**Уязвимость/Атака**<br>
**Код CWE:** [CWE-79][cwe-79]<br>
**Код Валарм:** `xss`

**Описание:**

Межсайтовый скриптинг — это вид атаки на клиентов веб‑приложения, при которой в браузере клиентов может быть исполнен произвольный код, подготовленный злоумышленником.

Различают несколько видов XSS:
*   Хранимый XSS (англ. Stored XSS).
    
    Вредоносный код заранее внедрен на страницу приложения.
    
    Уязвимость к данной атаке позволяет злоумышленнику внедрить вредоносный код в HTML-страницу веб‑приложения с возможностью постоянного отображения этого кода в браузере всех клиентов, обратившихся к данной странице.

*   Отраженный XSS (англ. Reflected XSS).
    
    Для произведения атаки злоумышленнику необходимо спровоцировать пользователя перейти по специально сформированной ссылке.

*   DOM-based XSS.

    Уязвимость к DOM-based XSS-атакам появляется в случаях, когда JavaScript-код страницы веб‑приложения обрабатывает отправляемые данные, и из‑за ошибок в коде реализации может попытаться исполнить полученный набор данных в качестве команд языка JavaScript.

В результате реализации любой из вышеперечисленных атак в браузере клиента будет выполнен произвольный JavaScript-код, который может позволить злоумышленнику украсть пользовательскую сессию, производить запросы от имени пользователя, получить пользовательские учетные данные и выполнять иные вредоносные действия.

Уязвимость к атакам данного типа возникает из‑за некорректной фильтрации входных пользовательских данных.

**Рекомендации по устранению:**

Вы можете последовать следующим рекомендациям:
*   Параметры, получаемые веб‑приложением, должны проходить процессы санитизации (англ. sanitization) и фильтрации для предотвращения исполнения управляющих конструкций.
*   При формировании страницы веб‑приложения проводить санитизацию и экранирование управляющих конструкций из динамически собирающихся данных.
*   Рекомендации из [OWASP XSS Prevention Cheatsheet][link-owasp-xss-cheatsheet]. 


### Небезопасная прямая ссылка на объект (англ. Insecure Direct Object References, IDOR)

**Уязвимость**<br>
**Код CWE:** [CWE-639][cwe-639]<br>
**Код Валарм:** `idor`

**Описание:**

Функции авторизации приложения не препятствуют тому, чтобы один пользователь не мог получить доступ к данным или ресурсам другого пользователя.

Данная уязвимость возникает из‑за того, что веб‑приложение предоставляет возможность, изменив значение ключа, получить прямую ссылку на объект, например файл, каталог или запись в базе данных и не осуществляет соответствующий контроль доступа.

В процессе эксплуатации уязвимости злоумышленник за счёт манипуляций с параметрами запроса может получить несанкционированный доступ к конфиденциальной информации веб‑приложения и пользователей.

**Рекомендации по устранению:**

Вы можете последовать следующим рекомендациям:
*   реализовать корректную проверку контроля доступа к ресурсам веб‑приложения;
*   реализовать механизм контроля доступа к ресурсам и разграничивать доступ к ним в соостветствии с правами пользователя;
*   использовать косвенные ссылки на объекты;
*   воспользоваться рекомендациями из [OWASP IDOR Prevention Cheatsheet][link-owasp-idor-cheatsheet].


### Небезопасное перенаправление (англ. Open Redirect)

**Атака**<br> 
**Код CWE:** [CWE-601][cwe-601]<br>
**Код Валарм:** `redir`

**Описание:**

Небезопасное перенаправление - это атака, в результате которой злоумышленник может перенаправить пользователя на вредоносную страницу от имени легитимного веб‑приложения. 

Уязвимость к атакам данного типа возникает из‑за некорректной фильтрации входных данных URL-адреса.

**Рекомендации по устранению:**

Вы можете последовать следующим рекомендациям:
*   Параметры, получаемые веб‑приложением, должны проходить процессы санитизации (англ. sanitization) и фильтрации для предотвращения исполнения управляющих конструкций.
*   Следует уведомлять пользователя о всех перенаправлениях и запрашивать их подтверждение для перехода по ссылке.


### Подделка запросов на стороне сервера (англ. Server-Side Request Forgery, SSRF)

**Уязвимость**<br>
**Код CWE:** [CWE-918][cwe-918]<br>
**Код Валарм:** `ssrf`

**Описание:**

SSRF - вид атаки на веб-сервер, которая позволяет злоумышленнику выполнять запросы от имени веб-сервера. Реализация данной атаки может привести к получению информации о локальных портах веб‑приложения, сканированию внутренней сети, а также обходу ограничений доступа.

**Рекомендации по устранению:**

Вы можете последовать следующим рекомендациям:
*   Параметры, получаемые веб‑приложением, должны проходить процессы санитизации (англ. sanitization) и фильтрации для предотвращения исполнения управляющих конструкций.
*   Рекомендации из [OWASP SSRF Prevention Cheatsheet][link-owasp-ssrf-cheatsheet]. 

### Принудительный просмотр ресурсов веб‑приложения (англ. Forced Browsing)

**Атака**<br> 
**Код CWE:** [CWE-425][cwe-425]<br>
**Код Валарм:** `dirbust`

**Описание:**

Эта атака является одной из разновидностей [bruteforce-атак][anchor-brute]. Она направлена на обнаружение скрытых ресурсов веб‑приложения, а именно директорий и файлов. Атака достигает своей цели путем перебора различных имен файлов и директорий, причем эти имена могут быть как сгенерированы на основе заданного шаблона, так и взяты из предварительно подготовленного словаря.

В результате реализации атаки злоумышленником может быть получен доступ к скрытым ресурсам, на которые веб‑приложение не ссылается явно, но которые доступны при обращении к ним напрямую.

**Рекомендации по устранению:**

Вы можете последовать следующим рекомендациям:
*   запретить или максимально ограничить доступ ко всем ресурсам веб‑приложения, к которым пользователь не должен иметь прямого доступа (например, с помощью механизмов аутентификации и авторизации);
*   ввести ограничения на количество поступающих запросов к веб‑приложению в единицу времени;
*   ввести ограничения на количество попыток аутентификации или авторизации в единицу времени;
*   блокировать дальнейшие попытки аутентификации и авторизации после нескольких неудачных попыток;
*   установить минимально возможные права на доступ к директориям и файлам веб‑приложения.

[Как настроить Валарм WAF для защиты от брутфорса →](admin-ru/configuration-guides/protecting-against-bruteforce.md)

??? info "Смотреть видео Валарм о брутфорс‑атаках"
    <div class="video-wrapper">
    <iframe width="1280" height="720" src="https://www.youtube.com/embed/0R_2wL5_a-I" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
    </div>

### Раскрытие информации (англ. Information Exposure)

**Уязвимость/Атака**<br>
**Код CWE:** [CWE-200][cwe-200] (смотрите также: [CWE-209][cwe-209], [CWE-215][cwe-215], [CWE-538][cwe-538], [CWE-541][cwe-541], [CWE-548][cwe-548])<br>
**Код Валарм:** `infoleak`

**Описание:**

Защищаемое приложение раскрывает чувствительную информацию субъекту, который явно не уполномочен иметь доступ к этой информации.

Уязвимость этого типа может быть обнаружена только методом [пассивного детектирования](about-wallarm-waf/detecting-vulnerabilities.md#пассивное-детектирование). Если ответ на запрос содержит чувствительную информацию, Валарм записывает инцидент и активную уязвимость типа **Раскрытие информации**. Валарм распознает следующую информацию как чувствительную:

* Статус системы и среды (например: stack trace, фатальные ошибки, предупреждения)
* Статус и настройки сети
* Код приложения
* Метаданные (например: лог подключений к приложению)

**Рекомендации по устранению:**

Вы можете последовать следующей рекомендации: исключить вывод чувствительной информации на страницах веб‑приложения.


### Удаленное выполнение кода (англ. Remote Code Execution, RCE)

**Уязвимость/Атака**<br>
**Коды CWE:** [CWE-78][cwe-78], [CWE-94][cwe-94] и другие<br>
**Код Валарм:** `rce`

**Описание:**

Злоумышленник может внедрить вредоносный код в запрос к веб‑приложению, который затем будет исполнен веб‑приложением.  
Также злоумышленник может попытаться выполнить определенные команды операционной системы, в которой запущено уязвимое веб‑приложение.

В результате реализации атаки злоумышленнику может стать доступен широкий спектр действий, включающий в себя:

 *  влияние на целостность, доступность и конфиденциальность данных веб‑приложения;
 *  получение контроля за операционной системой и сервером, которые обеспечивают выполнение веб‑приложения;
 *  иные возможности.

Уязвимость к атакам данного типа возникает из‑за некорректной фильтрации входных пользовательских данных.

**Рекомендации по устранению:**

Вы можете последовать следующей рекомендации: параметры, получаемые веб‑приложением, должны проходить процессы санитизации (англ. sanitization) и фильтрации для предотвращения исполнения управляющих конструкций.


### Уязвимость в механизмах аутентификации (англ. Authentication Bypass)

**Уязвимость**<br> 
**Код CWE:** [CWE-288][cwe-288]<br>
**Код Валарм:** `auth`

**Описание:**

Программное обеспечение реализует механизм аутентификации пользователей, но приложение имеет альтернативные каналы аутентификации, позволяющие обойти основной механизм или воспользоваться его недочетами, для получения доступа с правами пользователя или администратора.

В результате наличия данной уязвимости, потенциальный злоумышленник может получить доступ к конфиденциальным данным пользователей или получить доступ к управлению приложением с правами администратора.  

**Рекомендации по устранению:**

Вы можете последовать следующим рекомендациям:
*   устранить недочеты существующего механизма аутентификации;
*   устранить любые сторонние каналы аутентификации, позволяющие потенциальным злоумышленникам получать доступ к приложению без прохождения корректного процесса аутентификации;
*   воспользоваться рекомендациями из [OWASP Authentication Cheatsheet][link-owasp-auth-cheatsheet].


### CRLF-инъекция (англ. CRLF Injection)

**Атака**<br> 
**Код CWE:** [CWE-93][cwe-93]<br>
**Код Валарм:** `crlf`

**Описание:**

CRLF-инъекции — это класс атак, который позволяет злоумышленнику внедрить символы возврата каретки (англ. Carriage Return, CR) и перевода строки (англ. Line Feed, LF) в запрос к серверу (например, с помощью протокола HTTP). 

В совокупности с другими факторами это может привести к эксплуатации различных уязвимостей (например, «HTTP Response Splitting» [CWE-113][cwe-113], «HTTP Response Smuggling» [CWE-444][cwe-444]).

Успешная атака такого типа может позволить злоумышленнику обходить файервол, отравлять кеш, подменять легитимные страницы на страницы с вредоносным кодом, реализовывать атаки типа «Open Redirect» и выполнять иные вредоносные действия.
 
Уязвимость к атакам данного типа возникает из‑за некорректной фильтрации входных пользовательских данных.

**Рекомендации по устранению:**

Вы можете последовать следующей рекомендации: параметры, получаемые веб‑приложением, должны проходить процессы санитизации (англ. sanitization) и фильтрации для предотвращения исполнения управляющих конструкций.


### LDAP-инъекция (англ. LDAP Injection)

**Уязвимость/Атака**<br>
**Код CWE:** [CWE-90][cwe-90]<br>
**Код Валарм:** `ldapi`

**Описание:**

LDAP-инъекции — это класс атак, который позволяет злоумышленнику внедрить мета‑символы фильтров поиска в запрос к структуре LDAP, хранящейся на сервере. 

В результате реализации атаки злоумышленник может получить доступ к чтению/изменению конфиденциальной информации о пользователях и узлах, представленных в структуре LDAP. 

Уязвимость к атакам данного типа возникает из‑за некорректной фильтрации входных пользовательских данных.

**Рекомендации по устранению:**

Вы можете последовать следующим рекомендациям:
*   Параметры, получаемые веб‑приложением, должны проходить процессы санитизации (англ. sanitization) и фильтрации для предотвращения исполнения управляющих конструкций.
*   Рекомендации из [OWASP LDAP Injection Prevention Cheatsheet][link-owasp-ldapi-cheatsheet].


### NoSQL‑инъекция (англ. NoSQL Injection)

**Уязвимость/Атака**<br>
**Код CWE:** [CWE-943][cwe-943]<br>
**Код Валарм:** `nosqli`

**Описание:**

NoSQL‑инъекции — это класс атак, которые позволяют злоумышленнику получить возможность доступа к конфиденциальным данным веб‑приложения. Атаки этого типа реализуются из‑за недостаточной фильтрации входных пользовательских данных, путем внедрения специально сконструированного запроса к NoSQL‑базе данных.

**Рекомендации по устранению:**

Вы можете последовать следующей рекомендации: параметры, получаемые веб‑приложением, должны проходить процессы санитизации (англ. sanitization) и фильтрации для предотвращения исполнения управляющих конструкций.


### Path Traversal

**Уязвимость/Атака**<br>
**Код CWE:** [CWE-22][cwe-22]<br>
**Код Валарм:** `ptrav`

**Описание:**

Path Traversal - это тип атаки, которая позволяет злоумышленнику получить доступ к конфиденциальным файлам и каталогам, хранящимся в файловой системе веб‑приложения с помощью изменения существующих путей к файлам через параметры веб‑приложения. 

Уязвимость к данному типу атак возникает из‑за некорректной фильтрации пользовательских данных при запросе пользователем файлов или директорий через веб‑приложение.

**Рекомендации по устранению:**

Вы можете последовать следующим рекомендациям:
*   Параметры, получаемые веб‑приложением, должны проходить процессы санитизации (англ. sanitization) и фильтрации для предотвращения исполнения управляющих конструкций.
*   Дополнительные рекомендации по предотвращению данного типа атак доступны [здесь][link-ptrav-mitigation].


### SQL‑инъекция (SQL Injection)

**Уязвимость/Атака**<br>
**Код CWE:** [CWE-89][cwe-89]<br>
**Код Валарм:** `sqli`

**Описание:**

Атака этого типа реализуется из‑за недостаточной фильтрации входных пользовательских данных, путем внедрения специально сконструированного SQL‑запроса.

Уязвимость к атаке типа «SQL‑инъекция» позволяет злоумышленнику внедрить в выполняемый запрос к базе данных произвольный SQL‑код, получив возможность доступа к конфиденциальным данным, их изменению, а также выполнению операций по администрированию СУБД.

**Рекомендации по устранению:**

Вы можете последовать следующим рекомендациям:
*   Параметры, получаемые веб‑приложением, должны проходить процессы санитизации (англ. sanitization) и фильтрации для предотвращения исполнения управляющих конструкций.
*   Рекомендации из [OWASP SQL Injection Prevention Cheatsheet][link-owasp-sqli-cheatsheet].


##  Список особых атак и уязвимостей

### Виртуальный патч (англ. Virtual Patch)

**Атака**<br>
**Код Валарм:** `vpatch`

**Описание:**     

Такой код присваивается атакам, которые были отражены с помощью механизма [виртуальных патчей][doc-vpatch].


### Использование небезопасного XML‑заголовка

**Атака**<br>
**Код Валарм:** `xml_unsafe_header`

**Описание:**  

Запрос помечается как атака такого типа, если тело запроса представляет собой XML‑документ и замечено несоответствие между кодировкой этого документа и кодировкой, указанной в заголовке XML‑документа.

### Превышение лимита вычислительных ресурсов

**Атака**<br>
**Код Валарм:** `overlimit_res`

**Описание:**

WAF‑нода настроена так, что на обработку одного входящего запроса должно тратиться не более `N` миллисекунд (значение по умолчанию: `1000`). Если обработка запроса не будет выполнена за установленный квант времени, то она будет прекращена, а сам запрос будет помечен как атака типа «превышение лимита вычислительных ресурсов».

Вы можете задать требуемый вам лимит времени для обработки запроса с помощью директивы Валарм [`wallarm_process_time_limit`][link-wl-process-time-limit-directive].