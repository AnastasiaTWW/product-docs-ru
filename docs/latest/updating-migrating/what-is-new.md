# Что нового в WAF‑ноде 2.18

## Критическое изменение

Начиная с образа WAF‑ноды 2.16.0-8, переменная `WALLARM_ACL_ENABLE` для [Docker-контейнера на основе NGINX](../admin-ru/installation-docker-ru.md#запуск-контейнера-с-переменными-окружения) принимает только значения `true` и `false`.

!!! warning "Значения `on` / `enabled` / `ok` / `yes`"
    Значения `on` / `enabled` / `ok` / `yes` переменной `WALLARM_ACL_ENABLE` отключают блокировку по IP‑адресам. Мы рекомендуем использовать последнюю версию образа, указанную в [инструкции по запуску Docker-контейнера](../admin-ru/installation-docker-ru.md), и передавать в переменной значение `true` или `false`.

## Новые возможности продукта

* Новая переменная `wallarm_attack_type_list` для настройки расширенного логирования WAF‑ноды. В переменную записываются обнаруженные типы атак в текстовом формате.
    
    [Подробное описание переменной `wallarm_attack_type_list` →](../admin-ru/configure-logging.md#переменные-wafноды)
* Новый способ настройки страницы блокировки и кода ошибки, которые возвращаются клиенту в ответ на заблокированный запрос. Теперь чтобы возвращать разные ответы на запросы, отправленные с разных устройств или приложений, вы можете передать переменную в значении директив `wallarm_block_page` и `wallarm_acl_block_page`.
    
    [Подробная инструкция по настройке ответа через переменную →](../admin-ru/configuration-guides/configure-block-page-and-code.md#переменная-и-код-ошибки)
* Новый параметр статистики WAF‑ноды: `startid`. В параметр записывается случайный уникальный идентификатор WAF‑ноды.
    
    [Список всех параметров сервиса статистики →](../admin-ru/configure-statistics-service.md#работа-с-сервисом-статистики)
* Поддержка новой аннотации Ingress‑контроллера Валарм: `nginx.ingress.kubernetes.io/wallarm-acl-block-page`. Аннотация ипользуется для настройки страницы блокировки и кода ошибки, которые возвращаются в ответ на запрос с заблокированного IP‑адреса.
    
    [Пример настройки ответа через аннотацию `nginx.ingress.kubernetes.io/wallarm-acl-block-page` →](../admin-ru/configure-kubernetes-ru.md#настройка-страницы-блокировки-и-кода-ошибки)
* Снижено количество ресурсов, которое выделяется для сервиса постаналитики при деплое облачного образа WAF‑ноды по умолчанию.
    
    В предыдущих вериях WAF‑ноды, развернутый образ WAF‑ноды выделял 75% общей памяти инстанса для Tarantool. В WAF‑ноде версии 2.18, для Tarantool выделяется 40% общей памяти инстанса.

## Процедура обновления

Для обновления WAF‑ноды рекомендуется ознакомиться с общими рекомендациями к процессу и перейти к инструкции по обновлению установленных модулей:

* [Общие рекомендации к обновлению WAF‑ноды](general-recommendations.md)
* [Обновление модулей NGINX, NGINX Plus, Kong](nginx-modules.md)
* [Обновление Docker‑контейнера с модулями для NGINX или Envoy](docker-container.md)
* [Обновление Ingress‑контроллера NGINX с сервисами Валарм WAF](ingress-controller.md)
* [Обновление облачного образа WAF‑ноды](cloud-image.md)

----------

[Другие обновления в продуктах и компонентах Валарм →](https://changelog.wallarm.ru/)
