# Определение счетчиков атак

## Обзор правил

Правила **Определить счетчик атак forced browsing** и **Определить счетчик атак перебора** используются для добавления к конкретным запросам тегов, по которым модуль постаналитики определяет атаки типа [дирбаст (forced browsing)](../../attacks-vulns-list.md#принудительный-просмотр-ресурсов-вебприложения-англ-forced-browsing) и [брутфорс (brute‑force)](../../attacks-vulns-list.md#брутфорс-англ-bruteforce-attack) соответственно.

!!! info "Применение правила к реальному трафику"
    Чтобы применить правило к реальному трафику, необходимо задать порог для срабатывания правила:

    * Количество ответов с кодом 404 для правила **Определить счетчик атак forced browsing**
    * Количество запросов для правила **Определить счетчик атак перебора**

    Пороги определяются с помощью триггеров. Примеры триггеров доступны по [ссылке](../triggers/trigger-examples.md#отметка-о-брутфорсе-или-дирбасте-при-31-и-более-запросе-за-30-секунд).

## Создание и применение правила

Чтобы создать и применить правило:

1. Создайте правило **Определить счетчик атак forced browsing** или **Определить счетчик атак перебора** в секции **Правила** в Консоли управления. Правило состоит из следующих частей:

      * **Условие** описывает запрос, к которому необходимо добавить тег атаки типа дирбаст (forced browsing) или брутфорс (brute‑force).
      * **Имя счетчика** определяет название тега, который будет добавлен к запросу, соответствующему условию. Имя должно соответствовать маске:
        * `d:<name>` для правила **Определить счетчик атак forced browsing**
        * `b:<name>` для правила **Определить счетчик атак перебора**

    !!! info "Подсказка об унаследованном счетчике"
        При создании правила на определение счетчика, в интерфейсе может появиться подсказка `Унаследованный счетчик: <name>`. Подсказка появляется, если в вашем аккаунте создано **Правило по умолчанию** на определение счетчика. **Правило по умолчанию** применяется ко всем запросам (в правиле не описаны условия срабатывания).

        Подсказка имеет информационный характер и не влияет на правило с описанными условиями срабатывания. Правило с описанными условиями срабатывания будет иметь более высокий приоритет, чем **Правило по умолчанию**.

2. Создайте триггер с порогом для срабатывания правила. Примеры триггеров доступны по [ссылке](../triggers/trigger-examples.md#отметка-о-брутфорсе-или-дирбасте-при-31-и-более-запросе-за-30-секунд).

## Примеры правил

* Добавить тег атаки типа дирбаст (forced browsing) `d:api_fr_user_passwords` к запросам, отправленным на защищенный ресурс по пути `api/frontend/user/passwords`
* Добавить тег атаки типа брутфорс (brute‑force) `b:api_fr_user_login` к запросам, отправленным на защищенный ресурс по пути `api/frontend/user/login`

![!Пример счетчиков дирбаст и брутфорс атак](../../images/user-guides/rules/dirbust-brute-counter-examples.png)
