При активной проверке атак генерируется набор тестовых запросов с разными векторами атак, направленными на один адрес приложения. Каждый ответ приложения на запрос анализируется на наличие признаков активной уязвимостей:

* Если в ответе нет признаков уязвимостей, которые могут быть проэксплуатированы отправленными векторами атак, модуль считает приложение не уязвимым для этих векторов.
* Если в ответе есть признаки уязвимостей, которые могут быть проэксплуатированы отправленными векторами атак, модуль регистрирует активные уязвимости и инцидент безопасности.

[Список уязвимостей, которые может обнаружить модуль](../attacks-vulns-list.md)

Модуль активной проверки атак использует следующий механизм для проверки приложений и API на наличие активных уязвимостей:

1. Для каждый группы вредоносных запросов (атаки), Валарм WAF определяет атакуемый элемент запроса (например: URL, объект JSON, поле XML) и тип уязвимости, которую злоумышленник пытался эксплуатировать (например: SQLi, RCE, XSS). Например, следующий GET-запрос имеет характеристики:

    ```bash
    https://example.com/login?token=IyEvYmluL3NoCg&user=UNION SELECT username, password
    ```

    * Атакуемый URL: `https://example.com/login`.
    * Тип отправленной атаки: SQLi. Тип определен на основе вектора атаки `UNION SELECT username, password`.
    * Атакуемый GET-параметр: `user`.
    * Дополнительная информация, отправленная для авторизации запроса: `token=IyEvYmluL3NoCg`.
2. На основе определенных данных, модуль активной проверки атак генерирует набор из 100-150 тестовых запросов с разными векторами атаки одного типа (SQLi) и с одинаковым адресом, на который запрос был отправлен изначально. Например:

    ```bash
    https://example.com/login?token=IyEvYmluL3NoCg&user=1')+WAITFOR+DELAY+'0 indexpt'+AND+('wlrm'='wlrm
    https://example.com/login?token=IyEvYmluL3NoCg&user=1+AND+SLEEP(10)--+wlrm
    https://example.com/login?token=IyEvYmluL3NoCg&user=1);SELECT+PG_SLEEP(10)--
    https://example.com/login?token=IyEvYmluL3NoCg&user=1'+OR+SLEEP(10)+AND+'wlrm'='wlrm
    https://example.com/login?token=IyEvYmluL3NoCg&user=1+AND+1=(SELECT+1+FROM+PG_SLEEP(10))
    https://example.com/login?token=IyEvYmluL3NoCg&user=%23'%23\x22%0a-sleep(10)%23
    https://example.com/login?token=IyEvYmluL3NoCg&user=1';+WAITFOR+DELAY+'0code:10'--
    https://example.com/login?token=IyEvYmluL3NoCg&user=1%27%29+OR+SLEEP%280%29+AND+%28%27wlrm%27%3D%27wlrm
    https://example.com/login?token=IyEvYmluL3NoCg&user=SLEEP(10)/*'XOR(SLEEP(10))OR'|\x22XOR(SLEEP(10))OR\x22*/
    ```
3. Модуль активной проверки атак отправляет сгенерированные запросы приложению и определяет уязвимость приложения по указанному адресу к отправленному типу атаки. Если приложение уязвимо, модуль регистрирует соответствующее событие с типом [инцидент](../user-guides/events/check-attack.md#инциденты).

    При этом запросы не должны проверяться WAF-нодой на наличие атак, для этого необходимо [добавить IP-адреса Сканера Валарм в белый список][whitelist-scanner-addresses].

    !!! info "Значение HTTPS-заголовка `User-Agent` в запросах"
        Заголовок `User-Agent` в запросах модуля активной проверки атак имеет значение `Wallarm attack-rechecker (v1.x)`.
4. Обнаруженные инциденты безопасности отображаются в Консоли управления Валарм. Чтобы отправить информацию об инцидентах вашей команде, вы можете настроить [интеграции](../user-guides/settings/integrations/integrations-intro.md) со сторонними приложениями и [Триггеры](../user-guides/triggers/triggers.md).
