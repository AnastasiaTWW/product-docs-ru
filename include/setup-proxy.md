!!! info
    Данный этап настройки предназначен для пользователей, использующих свой прокси‑сервер для работы защищаемых веб‑приложений.
    
    Если Вы не используете прокси‑сервер, пропустите этот этап настройки.

Чтобы настроить WAF‑ноду Валарм для использования вашего прокси‑сервера, необходимо присвоить новые значения переменным окружения, которые определяют используемый прокси‑сервер.

Добавьте в файл `/etc/environment` новые значения переменных окружения:
*   `https_proxy` — прокси для протокола HTTPS;
*   `http_proxy` — прокси для протокола HTTP;
*   `no_proxy` — ресурсы, для запросов к которым необходимо отключить проксирование.

Присвойте переменным `https_proxy` и `http_proxy` строки вида `<scheme>://<proxy_user>:<proxy_pass>@<host>:<port>`, где:
* `<scheme>` — используемый протокол (должен совпадать с протоколом, для которого настраивается прокси в текущей переменной окружения);
* `<proxy_user>` — имя пользователя для авторизации на прокси‑сервере;
* `<proxy_pass>` — пароль для авторизации на прокси‑сервере;
* `<host>` — хост используемого прокси‑сервера;
* `<port>` — порт используемого прокси‑сервера.

Присвойте переменной `no_proxy` значение в виде массива IP‑адресов и/или доменов, к которым нужно обращаться без использования прокси: `"<res_1>, <res_2>, <res_3>, <res_4>, ..."`, где `<res_1>`, `<res_2>`, `<res_3>` и `<res_4>` — IP‑адреса и/или домены.

!!! warning "Ресурсы, к которым нужно обращаться без использования прокси"
    Для корректной работы системы в список ресурсов, к которым нужно обращаться без прокси, необходимо добавить следующие IP‑адреса и домен: `127.0.0.1`, `127.0.0.8`, `127.0.0.9` и `localhost`.
    
    IP‑адреса `127.0.0.8` и `127.0.0.9` используются для работы WAF‑ноды Валарм. 

Пример корректного содержимого файла `/etc/environment` ниже демонстрирует следующую конфигурацию: 
*   HTTPS‑ и HTTP‑запросы проксируются на хост `1.2.3.4` с портом `1234`, используя для авторизации на прокси‑сервере имя пользователя `admin` и пароль `01234`.
*   для запросов к `127.0.0.1`, `127.0.0.8`, `127.0.0.9` и `localhost` проксирование отключено.

```
https_proxy=http://admin:01234@1.2.3.4:1234
http_proxy=http://admin:01234@1.2.3.4:1234
no_proxy="127.0.0.1, 127.0.0.8, 127.0.0.9, localhost"
```
